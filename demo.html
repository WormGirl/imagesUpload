<!DOCTYPE html>
<html>
<head lang="zh">
    <meta charset="UTF-8">
    <title>demo</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <style>
      .upload-btn{
        text-align: center;
      }
      .upload-wrap{
        position: relative;
        display: inline-block;
        width: 300px;
        height: 140px;
        background: url("img/btn.png") no-repeat;
        background-size: 100% 100%;
      }
      #file{
        position: absolute;
        width: 100%;
        left:0;
        bottom: 0;
        opacity: 0;
        height: 100%;
      }
      #previewResult{
        width: 100%;
      }
    </style>
</head>
<body>
  <!-- 代码部分begin -->
  <div class="upload-btn">
    <div class="upload-wrap">
      <img id="previewResult"/>
      <input type="file" id="file" accept="image/*"/>
    </div>
    <img id="preview"/>
  </div>
</body>
<script type="text/javascript" src="js/JQuery-3.1.1.min.js"></script>
<script src="js/resize.min.js"></script>
<script src="js/alloy_crop.js"></script>
<script src="js/transform.js"></script>
<script src="js/alloy_finger.js"></script>
<script type="text/javascript">
(function () {
    var _input = document.querySelector('#file')
    _input.addEventListener('change', function (e) {
      canvasResize(this.files[0], {
        crop: false,
        quality: 0.9,
        rotate: 0,
        callback(baseStr) {
            $("#preview").attr("src",baseStr).hide();
            var crop_btn = document.querySelector("#crop_btn");
            new AlloyCrop({
                image_src: $("#preview").attr("src"),
                width: 300,
                height: 300,
                ok_text: "确定", // optional parameters , the default value is ok
                cancel_text: "取消", // optional parameters , the default value is cancel
                ok: function (base64, canvas) {
                    $("#previewResult").attr('src',base64);
                    $(".file-input-mask").css("opacity","0");
                },
                cancel: function () {
                }
            });
        }
      })
    })
   })();
</script>
</html>
